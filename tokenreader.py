# !/usr/bin/python

import requests
import json
import os

file = open("names.json", "r")
x = file.read()

names = json.loads(x)
print(names)

os.chdir("Tokens")


for i in os.walk('.'):
    print(i[1])
    for z in range(0,len(i[1])):
        iterz = (i[1])[z]

        tokens = open(iterz+"/tokens")
        tokens = tokens.readlines()

        try:
            config = json.loads(open(iterz+"/config").read())
        except:
            print("h")
            config = json.loads(open(iterz+"/config").read())


        for h in range(0,config["max"]):
            token = tokens[h].strip('\n')
            print(token)
            print(names[h])

            data = {
                "contact":{
                    "name":names[h],
                    "email":names[h]+str(h)+"@gmail.com"
                    },

                "message":{
                    "content":"Hey, I'm "+names[h]+" and i need help","timestamp":"Wed Sep 29 2021 09:44:59 GMT+0400 (Gulf Standard Time)","referer_url":"https://pastrikk.com"
                    }
                }

            link = config["baseurl"]+"/api/v1/widget/conversations?website_token="+config["site_token"]

            headers = {
                "accept-language": "en-US,en;q=0.9",
                "content-type": "application/json;charset=UTF-8",
                "sec-ch-ua": "\"Chromium\";v=\"93\", \" Not;A Brand\";v=\"99\"",
                "sec-ch-ua-mobile": "?0",
                "sec-ch-ua-platform": "\"Linux\"",
                "sec-fetch-dest": "empty",
                "sec-fetch-mode": "cors",
                "sec-fetch-site": "same-origin",
                "x-auth-token": token
            }



            e = requests.post(link, json=data, headers=headers)

            print(link)
            print(data)
            print(headers)
            print(e.text)



